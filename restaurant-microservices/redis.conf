# Redis configuration optimized for Django caching

# Network
bind 0.0.0.0
port 6379
timeout 300

# Memory management
maxmemory 400mb
maxmemory-policy allkeys-lru
maxmemory-samples 5

# Persistence - optimized for caching
save 900 1
save 300 10
save 60 10000

# Append only file for durability
appendonly yes
appendfsync everysec

# Compression
rdbcompression yes

# Performance tuning
tcp-keepalive 300
tcp-backlog 511

# Hash table optimization
hash-max-ziplist-entries 512
hash-max-ziplist-value 64

# Set optimization
set-max-intset-entries 512

# List optimization
list-max-ziplist-size -2
list-compress-depth 0

# Database count (for multiple Django cache instances)
databases 16

# Logging
loglevel notice
logfile /data/redis.log

# Security
protected-mode no

# Client connections
maxclients 1000

# Lazy freeing (non-blocking deletion)
lazyfree-lazy-eviction yes
lazyfree-lazy-expire yes
lazyfree-lazy-server-del yes

# Threaded I/O (Redis 6+)
io-threads 2
io-threads-do-reads yes